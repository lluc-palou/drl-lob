<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2000 1000" width="2000" height="1000">
  <defs>
    <style>
      .preprocessing { fill: #b0b0b0; stroke: #000000; stroke-width: 1; }
      .encoder { fill: #b0b0b0; stroke: #000000; stroke-width: 1; }
      .decoder { fill: #a8d5a8; stroke: #000000; stroke-width: 1; }
      .quantizer { fill: #e8f4f8; stroke: #000000; stroke-width: 1; }
      .prior { fill: #b0b0b0; stroke: #000000; stroke-width: 1; }
      .ppo { fill: #b0b0b0; stroke: #000000; stroke-width: 1; }
      .latent-zq { fill: #ffb3c1; stroke: #000000; stroke-width: 1; }
      .lob-data { fill: #f4d47c; stroke: #000000; stroke-width: 1; }
      .arrow { fill: none; stroke: #000000; stroke-width: 1.5; marker-end: url(#arrowhead); }
      .text { font-family: 'Times New Roman', serif; font-size: 14px; text-anchor: middle; fill: #000000; font-style: italic; }
      .text-label { font-family: 'Times New Roman', serif; font-size: 11px; text-anchor: middle; fill: #000000; }
      .text-small { font-family: 'Times New Roman', serif; font-size: 10px; text-anchor: middle; fill: #000000; font-style: italic; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#000000" />
    </marker>
  </defs>
  
  <rect x="0" y="0" width="2000" height="1000" fill="#ffffff" />
  
  <!-- ========== ALL ARROWS IN BACKGROUND LAYER ========== -->
  
  <line x1="70" y1="550" x2="110" y2="550" class="arrow" />
  <path d="M 310,520 L 350,520 L 350,415 L 415,415" class="arrow" />
  <path d="M 310,580 L 350,580 L 350,665 L 415,665" class="arrow" />
  <line x1="450" y1="415" x2="500" y2="415" class="arrow" />
  <line x1="640" y1="415" x2="685" y2="415" class="arrow" />
  <line x1="785" y1="415" x2="830" y2="415" class="arrow" />
  <line x1="865" y1="415" x2="920" y2="415" class="arrow" />
  <line x1="1060" y1="415" x2="1105" y2="415" class="arrow" />
  <path d="M 845,375 L 845,200 L 1200,200" class="arrow" />
  <path d="M 845,465 L 845,632.5 L 1500,632.5" class="arrow" />
  <line x1="1330" y1="200" x2="1375" y2="200" class="arrow" />
  <line x1="1410" y1="200" x2="1460" y2="200" class="arrow" />
  <line x1="1600" y1="200" x2="1645" y2="200" class="arrow" />
  <path d="M 1390,260 L 1390,600 L 1500,600" class="arrow" />
  <line x1="450" y1="665" x2="1500" y2="665" class="arrow" />
  <line x1="1680" y1="632.5" x2="1730" y2="632.5" class="arrow" />
  
  <!-- ========== ALL COMPONENTS AND SEQUENCES IN FRONT LAYER ========== -->
  
  <!-- Raw LOB Snapshots: x -->
  <rect x="45" y="460" width="25" height="180" class="lob-data" opacity="0.5" />
  <rect x="40" y="465" width="25" height="180" class="lob-data" opacity="0.7" />
  <rect x="35" y="470" width="25" height="180" class="lob-data" />
  <text x="50" y="565" class="text" style="font-size: 24px;">x</text>
  <text x="50" y="665" class="text-label" style="font-size: 11px;">Raw LOB</text>
  <text x="50" y="679" class="text-label" style="font-size: 11px;">Snapshots</text>
  
  <!-- Preprocessing -->
  <rect x="110" y="460" width="200" height="180" class="preprocessing" />
  <text x="210" y="558" class="text-label" style="font-size: 18px;">Preprocessing</text>
  
  <!-- Standardized LOB: x -->
  <rect x="425" y="325" width="25" height="180" class="lob-data" opacity="0.5" />
  <rect x="420" y="330" width="25" height="180" class="lob-data" opacity="0.7" />
  <rect x="415" y="335" width="25" height="180" class="lob-data" />
  <text x="430" y="425" class="text" style="font-size: 24px;">x</text>
  <text x="430" y="530" class="text-label" style="font-size: 11px;">Standardized</text>
  <text x="430" y="544" class="text-label" style="font-size: 11px;">LOB Snapshots</text>
  
  <!-- Encoder -->
  <polygon points="500,325 640,365 640,465 500,505" class="encoder" />
  <text x="570" y="415" class="text-label" style="font-size: 16px;">VQ-VAE</text>
  <text x="570" y="434" class="text-label" style="font-size: 16px;">Encoder</text>
  
  <!-- Quantizer -->
  <rect x="685" y="365" width="100" height="100" class="quantizer" />
  <text x="735" y="410" class="text-label" style="font-size: 15px;">VQ-VAE</text>
  <text x="735" y="429" class="text-label" style="font-size: 15px;">Quantizer</text>
  
  <!-- z_q -->
  <rect x="840" y="365" width="25" height="100" class="latent-zq" opacity="0.5" />
  <rect x="835" y="370" width="25" height="100" class="latent-zq" opacity="0.7" />
  <rect x="830" y="375" width="25" height="100" class="latent-zq" />
  <text x="837" y="422" class="text" style="font-size: 16px;">z</text>
  <text x="845" y="427" class="text-small" style="font-size: 10px;">q</text>
  <text x="780" y="490" class="text-label" style="font-size: 11px;">Discrete</text>
  <text x="780" y="504" class="text-label" style="font-size: 11px;">Latent Repr.</text>
  
  <!-- Middle Decoder -->
  <polygon points="920,365 1060,325 1060,505 920,465" class="decoder" />
  <text x="990" y="415" class="text-label" style="font-size: 16px;">VQ-VAE</text>
  <text x="990" y="434" class="text-label" style="font-size: 16px;">Decoder</text>
  
  <!-- Reconstructed LOB: x̂ -->
  <rect x="1115" y="325" width="25" height="180" class="lob-data" opacity="0.5" />
  <rect x="1110" y="330" width="25" height="180" class="lob-data" opacity="0.7" />
  <rect x="1105" y="335" width="25" height="180" class="lob-data" />
  <text x="1120" y="425" class="text" style="font-size: 24px;">x̂</text>
  <text x="1120" y="530" class="text-label" style="font-size: 11px;">Reconstructed</text>
  <text x="1120" y="544" class="text-label" style="font-size: 11px;">LOB Snapshots</text>
  
  <!-- Prior -->
  <rect x="1200" y="150" width="130" height="100" class="prior" />
  <text x="1265" y="210" class="text-label" style="font-size: 18px;">Prior</text>
  
  <!-- z_q -->
  <rect x="1385" y="150" width="25" height="100" class="latent-zq" opacity="0.5" />
  <rect x="1380" y="155" width="25" height="100" class="latent-zq" opacity="0.7" />
  <rect x="1375" y="160" width="25" height="100" class="latent-zq" />
  <text x="1387" y="207" class="text" style="font-size: 16px;">z</text>
  <text x="1395" y="212" class="text-small" style="font-size: 10px;">q</text>
  <text x="1450" y="275" class="text-label" style="font-size: 11px;">Synthetic Discrete</text>
  <text x="1450" y="289" class="text-label" style="font-size: 11px;">Latent Repr.</text>
  
  <!-- Upper Decoder -->
  <polygon points="1460,150 1600,110 1600,290 1460,250" class="decoder" />
  <text x="1530" y="198" class="text-label" style="font-size: 16px;">VQ-VAE</text>
  <text x="1530" y="217" class="text-label" style="font-size: 16px;">Decoder</text>
  
  <!-- Synthetic LOB: x̂ -->
  <rect x="1655" y="110" width="25" height="180" class="lob-data" opacity="0.5" />
  <rect x="1650" y="115" width="25" height="180" class="lob-data" opacity="0.7" />
  <rect x="1645" y="120" width="25" height="180" class="lob-data" />
  <text x="1660" y="210" class="text" style="font-size: 24px;">x̂</text>
  <text x="1660" y="318" class="text-label" style="font-size: 11px;">Synthetic</text>
  <text x="1660" y="332" class="text-label" style="font-size: 11px;">LOB Snapshots</text>
  
  <!-- Manual Features: f -->
  <rect x="425" y="575" width="25" height="180" class="lob-data" opacity="0.5" />
  <rect x="420" y="580" width="25" height="180" class="lob-data" opacity="0.7" />
  <rect x="415" y="585" width="25" height="180" class="lob-data" />
  <text x="430" y="680" class="text" style="font-size: 24px;">f</text>
  <text x="430" y="780" class="text-label" style="font-size: 11px;">Manually Derived</text>
  <text x="430" y="794" class="text-label" style="font-size: 11px;">Features</text>
  
  <!-- PPO -->
  <rect x="1500" y="580" width="180" height="110" class="ppo" />
  <text x="1590" y="630" class="text-label" style="font-size: 17px;">Transformer +</text>
  <text x="1590" y="650" class="text-label" style="font-size: 17px;">PPO</text>
  
  <!-- Policy: π_θ(a|s) -->
  <text x="1745" y="629.5" class="text" style="font-size: 18px;">π</text>
  <text x="1755" y="632.5" class="text-small" style="font-size: 13px;">θ</text>
  <text x="1780" y="629.5" class="text" style="font-size: 18px;">(a|s)</text>
  <text x="1760" y="653" class="text-label" style="font-size: 12px;">Stochastic Policy</text>
</svg>
